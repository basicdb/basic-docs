---
title: 'Get started with the Basic API'
description: 'Adding authentication to your project with the Basic API'
---
<Info>
    For built-in local-first benefits like offline support and instant UI, please use [create-lofi-app](/get-started/implement-basic/create-lofi-app) or the [Basic SDK](/get-started/implement-basic/using-react). The API currently does not include these benefits.
</Info>
# Summary
1. Implement a "Sign in with Basic" button in your app to redirect your user to a login page. User logs in Basic.id which grants them permissions to your app, and is redirected back to your app with an authorization code.
2. Extract the authorization code
3. Exchange the authorization code for access and refresh tokens. With the access token, you can make database requests and keep the user logged in
4. When the access token expires, use the refresh token to get a new access token

With this, you'll be ready to [access the user's database](/api-reference/db/get-items)!

# Authentication with API
Basic uses OAuth 2.0 for authentication. For more details, read about [Basic Auth](/info/auth-basic#introduction-to-oauth-2-0).

<Steps>
    <Step title="Implement a 'Sign in with Basic' button">
        Create a button that redirects the user to the Basic Auth page using /authorize, with the following required parameters (more info on [required parameters](/info/auth-basic#required-parameters)):
        - `client_id='YOUR_CLIENT_ID'`
        - `redirect_uri='YOUR_REDIRECT_URI'`
        - `response_type=code`
        - `scope=profile`
        - `state='YOUR_STATE'`
        
        Redirect URL template: `https://api.basic.tech/auth/authorize?response_type=code&redirect_uri=YOUR_REDIRECT_URI&scope=profile&state=YOUR_STATE&client_id=YOUR_CLIENT_ID`
        <Note>
            Make sure to replace `YOUR_CLIENT_ID`, `YOUR_REDIRECT_URI`, `YOUR_STATE` with your own values
        </Note>
        <CodeGroup>
            ```bash cURL
            curl --request GET \
                --url 'https://api.basic.tech/auth/authorize?response_type=code&redirect_uri='YOUR_REDIRECT_URI'&scope=profile&state='YOUR_STATE'&client_id='YOUR_CLIENT_ID''
            ```
            ```python Python
            import requests
            from urllib.parse import urlencode

            def redirect_to_auth():
                auth_params = {
                    "response_type": "code",
                    "client_id": "YOUR_CLIENT_ID",
                    "redirect_uri": "YOUR_REDIRECT_URI",
                    "scope": "profile",
                    "state": "YOUR_STATE"
                }
                
                auth_url = "https://api.basic.tech/auth/authorize?" + urlencode(auth_params)
                # In a web framework, return a redirect to auth_url
                return auth_url
            ``` 
            ```javascript JavaScript
            function redirectToAuth() {
                const authParams = new URLSearchParams({
                    response_type: 'code',
                    client_id: 'YOUR_CLIENT_ID',
                    redirect_uri: 'YOUR_REDIRECT_URI',
                    scope: 'profile',
                    state: 'YOUR_STATE'
                });

                const authUrl = `https://api.basic.tech/auth/authorize?${authParams.toString()}`;
                // Redirect the browser to the authorization URL
                window.location.href = authUrl;
            }

            // Usage (attach to button click):
            // <button onclick="redirectToAuth()">Sign in with Basic</button>
            ```
            ```php PHP
            <?php
            function redirectToAuth() {
                $auth_params = array(
                    'response_type' => 'code',
                    'client_id' => 'YOUR_CLIENT_ID',
                    'redirect_uri' => 'YOUR_REDIRECT_URI',
                    'scope' => 'profile',
                    'state' => 'YOUR_STATE'
                );
                
                $auth_url = 'https://api.basic.tech/auth/authorize?' . http_build_query($auth_params);
                
                // Redirect the user to the authorization URL
                header('Location: ' . $auth_url);
                exit();
            }
            ```
            ```go Go
            package main

            import (
                "fmt"
                "net/http"
                "net/url"
            )

            func redirectToAuth(w http.ResponseWriter, r *http.Request) {
                authParams := url.Values{}
                authParams.Add("response_type", "code")
                authParams.Add("client_id", "YOUR_CLIENT_ID")
                authParams.Add("redirect_uri", "YOUR_REDIRECT_URI")
                authParams.Add("scope", "profile")
                authParams.Add("state", "YOUR_STATE")

                authURL := "https://api.basic.tech/auth/authorize?" + authParams.Encode()
                
                // Redirect the user to the authorization URL
                http.Redirect(w, r, authURL, http.StatusTemporaryRedirect)
            }

            func main() {
                // Set up your HTTP server and routes
                http.HandleFunc("/login", redirectToAuth)
                
                fmt.Println("Server starting on :8080...")
                if err := http.ListenAndServe(":8080", nil); err != nil {
                    panic(err)
                }
            }
            ```
            ```java Java
            import javax.servlet.http.HttpServlet;
            import javax.servlet.http.HttpServletRequest;
            import javax.servlet.http.HttpServletResponse;
            import java.io.IOException;
            import java.net.URLEncoder;
            import java.nio.charset.StandardCharsets;
            import java.util.HashMap;
            import java.util.Map;
            import java.util.stream.Collectors;

            public class AuthRedirectServlet extends HttpServlet {
                @Override
                protected void doGet(HttpServletRequest request, HttpServletResponse response) 
                        throws IOException {
                    Map<String, String> authParams = new HashMap<>();
                    authParams.put("response_type", "code");
                    authParams.put("client_id", "YOUR_CLIENT_ID");
                    authParams.put("redirect_uri", "YOUR_REDIRECT_URI");
                    authParams.put("scope", "profile");
                    authParams.put("state", "YOUR_STATE");

                    String queryString = authParams.entrySet().stream()
                        .map(e -> e.getKey() + "=" + 
                             URLEncoder.encode(e.getValue(), StandardCharsets.UTF_8))
                        .collect(Collectors.joining("&"));

                    String authUrl = "https://api.basic.tech/auth/authorize?" + queryString;
                    
                    // Redirect the user to the authorization URL
                    response.sendRedirect(authUrl);
                }
            }
            ```
        </CodeGroup>
    </Step>

    <Step title="Extract the authorization code">
        The authorization code will be in the URL as a `code` query parameter.
        For example: 
        `https://your-app.com/callback?code=1234567890`.
        
        You need to extract the code from the URL and use it in the next step.

        Here are examples of how to extract the authorization code from the URL in different languages:

        <CodeGroup>
            ```bash cURL
            # For cURL, you typically don't need to extract the code from URL
            # as you'll receive it as a parameter to your callback endpoint
            # But if needed, you can use this command to extract from a URL:
            echo "https://your-app.com/callback?code=1234567890" | grep -o 'code=[^&]*' | cut -d'=' -f2
            ```
            ```python Python
            from urllib.parse import urlparse, parse_qs

            # Example URL
            url = "https://your-app.com/callback?code=1234567890"

            # Parse the URL and extract the code parameter
            parsed_url = urlparse(url)
            code = parse_qs(parsed_url.query)['code'][0]
            print(code)  # Output: 1234567890
            ```
            ```javascript JavaScript
            // If you're in the browser, you can use URLSearchParams
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');
            console.log(code);  // Output: 1234567890

            // Or if you have a URL string
            const url = "https://your-app.com/callback?code=1234567890";
            const searchParams = new URLSearchParams(new URL(url).search);
            const authCode = searchParams.get('code');
            console.log(authCode);  // Output: 1234567890
            ```
            ```php PHP
            <?php
            // If you're handling the callback directly
            $code = $_GET['code'];

            // Or if you need to parse from a URL string
            $url = "https://your-app.com/callback?code=1234567890";
            $query = parse_url($url, PHP_URL_QUERY);
            parse_str($query, $params);
            $code = $params['code'];
            echo $code;  // Output: 1234567890
            ```
            ```go Go
            package main

            import (
                "fmt"
                "net/url"
            )

            func main() {
                urlStr := "https://your-app.com/callback?code=1234567890"
                
                // Parse the URL
                parsedURL, err := url.Parse(urlStr)
                if err != nil {
                    panic(err)
                }
                
                // Get the query parameters
                queryParams := parsedURL.Query()
                
                // Extract the code
                code := queryParams.Get("code")
                fmt.Println(code)  // Output: 1234567890
            }
            ```
            ```java Java
            import java.net.URI;
            import java.net.URISyntaxException;
            import java.util.regex.Matcher;
            import java.util.regex.Pattern;

            public class ExtractAuthCode {
                public static void main(String[] args) throws URISyntaxException {
                    String url = "https://your-app.com/callback?code=1234567890";
                    
                    // Method 1: Using URI class
                    URI uri = new URI(url);
                    String query = uri.getQuery();
                    String[] params = query.split("&");
                    String code = "";
                    for (String param : params) {
                        if (param.startsWith("code=")) {
                            code = param.substring(5);
                            break;
                        }
                    }
                    System.out.println(code);  // Output: 1234567890
                    
                    // Method 2: Using regex
                    Pattern pattern = Pattern.compile("code=([^&]*)");
                    Matcher matcher = pattern.matcher(url);
                    if (matcher.find()) {
                        String authCode = matcher.group(1);
                        System.out.println(authCode);  // Output: 1234567890
                    }
                }
            }
            ```
        </CodeGroup>
    </Step>

    <Step title="Exchange the authorization code for an access token and a refresh code">
        Make a post request to `/token` with the authorization code in the body. The response will be a JSON object with the access token and a refresh code.

        Token URL template: 
        `https://api.basic.tech/auth/token`

        <Note>
            Make sure to replace `YOUR_CODE`, `YOUR_CLIENT_ID`, and `YOUR_CLIENT_SECRET` with your own values
        </Note>
        
        <CodeGroup>
            ```bash cURL
            curl --request POST \
                --url 'https://api.basic.tech/auth/token' \
                --header 'Content-Type: application/json' \
                --data '{
                    "grant_type": "authorization_code",
                    "code": "YOUR_CODE",
                    "client_id": "YOUR_CLIENT_ID",
                    "client_secret": "YOUR_CLIENT_SECRET"
                }'
            ```
            ```python Python
            import requests

            def exchange_code_for_tokens(code):
                url = "https://api.basic.tech/auth/token"
                
                payload = {
                    "grant_type": "authorization_code",
                    "code": code,
                    "client_id": "YOUR_CLIENT_ID",
                    "client_secret": "YOUR_CLIENT_SECRET"
                }
                headers = {"Content-Type": "application/json"}

                try:
                    response = requests.post(url, json=payload, headers=headers)
                    response.raise_for_status()
                    tokens = response.json()
                    return tokens["access_token"], tokens["refresh_token"]
                except requests.exceptions.RequestException as e:
                    print(f"Error exchanging code for tokens: {e}")
                    return None, None
            ```
            ```javascript JavaScript
            async function exchangeCodeForTokens(code) {
                try {
                    const response = await fetch('https://api.basic.tech/auth/token', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            grant_type: 'authorization_code',
                            code: code,
                            client_id: 'YOUR_CLIENT_ID',
                            client_secret: 'YOUR_CLIENT_SECRET'
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const tokens = await response.json();
                    return {
                        accessToken: tokens.access_token,
                        refreshToken: tokens.refresh_token
                    };
                } catch (error) {
                    console.error('Error exchanging code for tokens:', error);
                    return null;
                }
            }
            ```
            ```php PHP
            <?php

            function exchangeCodeForTokens($code) {
                $curl = curl_init();
                
                $payload = json_encode([
                    'grant_type' => 'authorization_code',
                    'code' => $code,
                    'client_id' => 'YOUR_CLIENT_ID',
                    'client_secret' => 'YOUR_CLIENT_SECRET'
                ]);

                curl_setopt_array($curl, [
                    CURLOPT_URL => "https://api.basic.tech/auth/token",
                    CURLOPT_RETURNTRANSFER => true,
                    CURLOPT_POST => true,
                    CURLOPT_POSTFIELDS => $payload,
                    CURLOPT_HTTPHEADER => [
                        "Content-Type: application/json",
                        "Content-Length: " . strlen($payload)
                    ]
                ]);

                try {
                    $response = curl_exec($curl);
                    $httpCode = curl_getinfo($curl, CURLINFO_HTTP_CODE);
                    
                    if ($httpCode !== 200) {
                        throw new Exception("HTTP error code: " . $httpCode);
                    }
                    
                    $tokens = json_decode($response, true);
                    return [
                        'access_token' => $tokens['access_token'],
                        'refresh_token' => $tokens['refresh_token']
                    ];
                } catch (Exception $e) {
                    error_log("Error exchanging code for tokens: " . $e->getMessage());
                    return null;
                } finally {
                    curl_close($curl);
                }
            }
            ```
            ```go Go
            package main

            import (
                "bytes"
                "encoding/json"
                "fmt"
                "net/http"
            )

            type TokenRequest struct {
                GrantType    string `json:"grant_type"`
                Code        string `json:"code"`
                ClientID    string `json:"client_id"`
                ClientSecret string `json:"client_secret"`
            }

            type TokenResponse struct {
                AccessToken  string `json:"access_token"`
                RefreshToken string `json:"refresh_token"`
            }

            func exchangeCodeForTokens(code string) (*TokenResponse, error) {
                tokenReq := TokenRequest{
                    GrantType:    "authorization_code",
                    Code:        code,
                    ClientID:    "YOUR_CLIENT_ID",
                    ClientSecret: "YOUR_CLIENT_SECRET",
                }

                jsonData, err := json.Marshal(tokenReq)
                if err != nil {
                    return nil, fmt.Errorf("error marshaling request: %v", err)
                }

                req, err := http.NewRequest("POST", "https://api.basic.tech/auth/token",
                    bytes.NewBuffer(jsonData))
                if err != nil {
                    return nil, fmt.Errorf("error creating request: %v", err)
                }

                req.Header.Set("Content-Type", "application/json")

                client := &http.Client{}
                resp, err := client.Do(req)
                if err != nil {
                    return nil, fmt.Errorf("error sending request: %v", err)
                }
                defer resp.Body.Close()

                if resp.StatusCode != http.StatusOK {
                    return nil, fmt.Errorf("unexpected status code: %d", resp.StatusCode)
                }

                var tokenResp TokenResponse
                if err := json.NewDecoder(resp.Body).Decode(&tokenResp); err != nil {
                    return nil, fmt.Errorf("error decoding response: %v", err)
                }

                return &tokenResp, nil
            }
            ```
            ```java Java
            import com.fasterxml.jackson.databind.ObjectMapper;
            import java.net.URI;
            import java.net.http.HttpClient;
            import java.net.http.HttpRequest;
            import java.net.http.HttpResponse;
            import java.util.Map;

            public class TokenExchange {
                private final String tokenUrl = "https://api.basic.tech/auth/token";
                private final HttpClient httpClient;
                private final ObjectMapper objectMapper;

                public TokenExchange() {
                    this.httpClient = HttpClient.newHttpClient();
                    this.objectMapper = new ObjectMapper();
                }

                public Map<String, String> exchangeCodeForTokens(String code) throws Exception {
                    Map<String, String> payload = Map.of(
                        "grant_type", "authorization_code",
                        "code", code,
                        "client_id", "YOUR_CLIENT_ID",
                        "client_secret", "YOUR_CLIENT_SECRET"
                    );

                    HttpRequest request = HttpRequest.newBuilder()
                        .uri(URI.create(tokenUrl))
                        .header("Content-Type", "application/json")
                        .POST(HttpRequest.BodyPublishers.ofString(
                            objectMapper.writeValueAsString(payload)))
                        .build();

                    HttpResponse<String> response = httpClient.send(request,
                        HttpResponse.BodyHandlers.ofString());

                    if (response.statusCode() != 200) {
                        throw new RuntimeException("Unexpected status code: " + 
                            response.statusCode());
                    }

                    return objectMapper.readValue(response.body(),
                        Map.class);
                }
            }
            ```
        </CodeGroup>
    </Step>

    <Step title="Using the access token and refresh code">
        The access token is used to make requests to the API as part of the request header (e.g., `Authorization: Bearer 'YOUR_ACCESS_TOKEN'`), and the refresh code is used to get a new access token when the current access token expires. 

        <Note>
            Basic access tokens expire after 1 hour
        </Note>

        Here are examples of how to check token expiration and refresh the access token:

        <CodeGroup>
            ```bash cURL
            # Refresh the access token using the refresh token
            curl --request POST \
                --url 'https://api.basic.tech/token' \
                --header 'Content-Type: application/json' \
                --data '{
                    "grant_type": "refresh_token",
                    "refresh_token": "YOUR_REFRESH_TOKEN"
                }'

            # The response will contain a new access token and refresh token
            ```
            ```python Python
            import requests
            import jwt
            from datetime import datetime, timezone

            class TokenManager:
                def __init__(self, access_token, refresh_token):
                    self.access_token = access_token
                    self.refresh_token = refresh_token
                    self.token_url = "https://api.basic.tech/token"

                def is_token_expired(self):
                    try:
                        # Decode the JWT token without verification
                        # In production, you should verify the token signature
                        payload = jwt.decode(self.access_token, options={"verify_signature": False})
                        expiry = datetime.fromtimestamp(payload['exp'], timezone.utc)
                        now = datetime.now(timezone.utc)
                        
                        # Return True if token is expired or about to expire in next 5 minutes
                        return (expiry - now).total_seconds() < 300
                    except jwt.ExpiredSignatureError:
                        return True
                    except Exception as e:
                        print(f"Error checking token expiration: {e}")
                        return True

                def refresh_access_token(self):
                    try:
                        response = requests.post(
                            self.token_url,
                            json={
                                "grant_type": "refresh_token",
                                "refresh_token": self.refresh_token
                            },
                            headers={"Content-Type": "application/json"}
                        )
                        response.raise_for_status()
                        
                        tokens = response.json()
                        self.access_token = tokens["access_token"]
                        self.refresh_token = tokens["refresh_token"]
                        return True
                    except Exception as e:
                        print(f"Error refreshing token: {e}")
                        return False

                def get_valid_access_token(self):
                    if self.is_token_expired():
                        self.refresh_access_token()
                    return self.access_token

            # Usage example:
            token_manager = TokenManager("YOUR_ACCESS_TOKEN", "YOUR_REFRESH_TOKEN")
            valid_token = token_manager.get_valid_access_token()
            ```
            ```javascript JavaScript
            class TokenManager {
                constructor(accessToken, refreshToken) {
                    this.accessToken = accessToken;
                    this.refreshToken = refreshToken;
                    this.tokenUrl = 'https://api.basic.tech/token';
                }

                isTokenExpired() {
                    try {
                        // Decode the JWT token (without verification)
                        // In production, you should verify the token signature
                        const payload = JSON.parse(atob(this.accessToken.split('.')[1]));
                        const expiryTime = payload.exp * 1000; // Convert to milliseconds
                        
                        // Return true if token is expired or will expire in next 5 minutes
                        return Date.now() >= (expiryTime - 5 * 60 * 1000);
                    } catch (error) {
                        console.error('Error checking token expiration:', error);
                        return true;
                    }
                }

                async refreshAccessToken() {
                    try {
                        const response = await fetch(this.tokenUrl, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                grant_type: 'refresh_token',
                                refresh_token: this.refreshToken
                            })
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const tokens = await response.json();
                        this.accessToken = tokens.access_token;
                        this.refreshToken = tokens.refresh_token;
                        return true;
                    } catch (error) {
                        console.error('Error refreshing token:', error);
                        return false;
                    }
                }

                async getValidAccessToken() {
                    if (this.isTokenExpired()) {
                        await this.refreshAccessToken();
                    }
                    return this.accessToken;
                }
            }

            // Usage example:
            const tokenManager = new TokenManager('YOUR_ACCESS_TOKEN', 'YOUR_REFRESH_TOKEN');
            tokenManager.getValidAccessToken().then(validToken => {
                // Use the valid token
                console.log(validToken);
            });
            ```
            ```php PHP
            <?php

            class TokenManager {
                private $accessToken;
                private $refreshToken;
                private $tokenUrl = 'https://api.basic.tech/token';

                public function __construct($accessToken, $refreshToken) {
                    $this->accessToken = $accessToken;
                    $this->refreshToken = $refreshToken;
                }

                public function isTokenExpired() {
                    try {
                        // Decode the JWT token (without verification)
                        // In production, you should verify the token signature
                        $tokenParts = explode('.', $this->accessToken);
                        $payload = json_decode(base64_decode($tokenParts[1]), true);
                        
                        // Check if token is expired or will expire in next 5 minutes
                        return time() >= ($payload['exp'] - 300);
                    } catch (Exception $e) {
                        error_log("Error checking token expiration: " . $e->getMessage());
                        return true;
                    }
                }

                public function refreshAccessToken() {
                    try {
                        $curl = curl_init();
                        curl_setopt_array($curl, [
                            CURLOPT_URL => $this->tokenUrl,
                            CURLOPT_RETURNTRANSFER => true,
                            CURLOPT_POST => true,
                            CURLOPT_POSTFIELDS => json_encode([
                                'grant_type' => 'refresh_token',
                                'refresh_token' => $this->refreshToken
                            ]),
                            CURLOPT_HTTPHEADER => [
                                'Content-Type: application/json'
                            ]
                        ]);

                        $response = curl_exec($curl);
                        $httpCode = curl_getinfo($curl, CURLINFO_HTTP_CODE);
                        curl_close($curl);

                        if ($httpCode === 200) {
                            $tokens = json_decode($response, true);
                            $this->accessToken = $tokens['access_token'];
                            $this->refreshToken = $tokens['refresh_token'];
                            return true;
                        }
                        return false;
                    } catch (Exception $e) {
                        error_log("Error refreshing token: " . $e->getMessage());
                        return false;
                    }
                }

                public function getValidAccessToken() {
                    if ($this->isTokenExpired()) {
                        $this->refreshAccessToken();
                    }
                    return $this->accessToken;
                }
            }

            // Usage example:
            $tokenManager = new TokenManager('YOUR_ACCESS_TOKEN', 'YOUR_REFRESH_TOKEN');
            $validToken = $tokenManager->getValidAccessToken();
            ```
            ```go Go
            package main

            import (
                "encoding/base64"
                "encoding/json"
                "fmt"
                "net/http"
                "strings"
                "time"
                "bytes"
            )

            type TokenManager struct {
                AccessToken  string
                RefreshToken string
                TokenURL     string
            }

            type TokenResponse struct {
                AccessToken  string `json:"access_token"`
                RefreshToken string `json:"refresh_token"`
            }

            type TokenPayload struct {
                Exp int64 `json:"exp"`
            }

            func NewTokenManager(accessToken, refreshToken string) *TokenManager {
                return &TokenManager{
                    AccessToken:  accessToken,
                    RefreshToken: refreshToken,
                    TokenURL:     "https://api.basic.tech/token",
                }
            }

            func (tm *TokenManager) IsTokenExpired() bool {
                // Split the token and decode the payload
                parts := strings.Split(tm.AccessToken, ".")
                if len(parts) != 3 {
                    return true
                }

                // Add padding if needed
                payload := parts[1]
                if l := len(payload) % 4; l > 0 {
                    payload += strings.Repeat("=", 4-l)
                }

                decoded, err := base64.URLEncoding.DecodeString(payload)
                if err != nil {
                    return true
                }

                var tokenPayload TokenPayload
                if err := json.Unmarshal(decoded, &tokenPayload); err != nil {
                    return true
                }

                // Check if token is expired or will expire in next 5 minutes
                return time.Now().Unix() >= (tokenPayload.Exp - 300)
            }

            func (tm *TokenManager) RefreshAccessToken() error {
                payload := map[string]string{
                    "grant_type":    "refresh_token",
                    "refresh_token": tm.RefreshToken,
                }

                jsonPayload, err := json.Marshal(payload)
                if err != nil {
                    return err
                }

                req, err := http.NewRequest("POST", tm.TokenURL, bytes.NewBuffer(jsonPayload))
                if err != nil {
                    return err
                }

                req.Header.Set("Content-Type", "application/json")

                client := &http.Client{}
                resp, err := client.Do(req)
                if err != nil {
                    return err
                }
                defer resp.Body.Close()

                if resp.StatusCode != http.StatusOK {
                    return fmt.Errorf("unexpected status code: %d", resp.StatusCode)
                }

                var tokenResponse TokenResponse
                if err := json.NewDecoder(resp.Body).Decode(&tokenResponse); err != nil {
                    return err
                }

                tm.AccessToken = tokenResponse.AccessToken
                tm.RefreshToken = tokenResponse.RefreshToken
                return nil
            }

            func (tm *TokenManager) GetValidAccessToken() (string, error) {
                if tm.IsTokenExpired() {
                    if err := tm.RefreshAccessToken(); err != nil {
                        return "", err
                    }
                }
                return tm.AccessToken, nil
            }

            // Usage example:
            func main() {
                tm := NewTokenManager("YOUR_ACCESS_TOKEN", "YOUR_REFRESH_TOKEN")
                validToken, err := tm.GetValidAccessToken()
                if err != nil {
                    fmt.Printf("Error getting valid token: %v\n", err)
                    return
                }
                fmt.Printf("Valid token: %s\n", validToken)
            }
            ```
            ```java Java
            import com.fasterxml.jackson.databind.ObjectMapper;
            import java.io.IOException;
            import java.net.URI;
            import java.net.http.HttpClient;
            import java.net.http.HttpRequest;
            import java.net.http.HttpResponse;
            import java.util.Base64;
            import java.util.Map;
            import java.time.Instant;

            public class TokenManager {
                private String accessToken;
                private String refreshToken;
                private final String tokenUrl = "https://api.basic.tech/token";
                private final HttpClient httpClient;
                private final ObjectMapper objectMapper;

                public TokenManager(String accessToken, String refreshToken) {
                    this.accessToken = accessToken;
                    this.refreshToken = refreshToken;
                    this.httpClient = HttpClient.newHttpClient();
                    this.objectMapper = new ObjectMapper();
                }

                public boolean isTokenExpired() {
                    try {
                        // Split the token and decode the payload
                        String[] parts = accessToken.split("\\.");
                        String payload = new String(Base64.getUrlDecoder().decode(parts[1]));
                        Map<String, Object> claims = objectMapper.readValue(payload, Map.class);
                        
                        // Get expiration time
                        long expTime = ((Number) claims.get("exp")).longValue();
                        
                        // Check if token is expired or will expire in next 5 minutes
                        return Instant.now().getEpochSecond() >= (expTime - 300);
                    } catch (Exception e) {
                        System.err.println("Error checking token expiration: " + e.getMessage());
                        return true;
                    }
                }

                public boolean refreshAccessToken() {
                    try {
                        Map<String, String> payload = Map.of(
                            "grant_type", "refresh_token",
                            "refresh_token", refreshToken
                        );

                        HttpRequest request = HttpRequest.newBuilder()
                            .uri(URI.create(tokenUrl))
                            .header("Content-Type", "application/json")
                            .POST(HttpRequest.BodyPublishers.ofString(objectMapper.writeValueAsString(payload)))
                            .build();

                        HttpResponse<String> response = httpClient.send(request, 
                            HttpResponse.BodyHandlers.ofString());

                        if (response.statusCode() == 200) {
                            Map<String, String> tokens = objectMapper.readValue(
                                response.body(), Map.class);
                            this.accessToken = tokens.get("access_token");
                            this.refreshToken = tokens.get("refresh_token");
                            return true;
                        }
                        return false;
                    } catch (Exception e) {
                        System.err.println("Error refreshing token: " + e.getMessage());
                        return false;
                    }
                }

                public String getValidAccessToken() {
                    if (isTokenExpired()) {
                        refreshAccessToken();
                    }
                    return accessToken;
                }

                // Usage example:
                public static void main(String[] args) {
                    TokenManager tokenManager = new TokenManager(
                        "YOUR_ACCESS_TOKEN",
                        "YOUR_REFRESH_TOKEN"
                    );
                    String validToken = tokenManager.getValidAccessToken();
                    System.out.println("Valid token: " + validToken);
                }
            }
            ```
        </CodeGroup>

        Each example implements a `TokenManager` class that handles:
        1. Checking if the current access token is expired (or will expire soon)
        2. Refreshing the access token using the refresh token when needed
        3. Providing a valid access token for API requests

        <Note>
            The token expiration check includes a 5-minute buffer to prevent using tokens that are about to expire.
            In production, you should also implement proper error handling, token storage, and token verification.
        </Note>
    </Step>
</Steps>

# Using the database
You can use the REST API to read and write to the user's database. Checkout the [API Reference](/api-reference/db/get-items) to get started.
Before making any requests, you should validate that the access token is not expired.

